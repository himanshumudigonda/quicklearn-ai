# Deploy Backend to Render - Simple Guide

## âœ… Pre-Deployment Checklist

Everything is ready! You have:
- âœ… Backend code complete
- âœ… Groq API key configured
- âœ… All 15+ models integrated
- âœ… `render.yaml` configured
- âœ… Environment variables documented

## ğŸš€ Deploy in 5 Minutes

### Step 1: Push to GitHub (2 min)

```bash
# Navigate to your project
cd "c:\Users\HIMANSHU\OneDrive\Desktop\projects\1 minute learner app"

# Initialize git (if not done)
git init
git add .
git commit -m "QuickLearn AI - Ready for deployment"

# Create GitHub repo and push
# Go to github.com â†’ New Repository â†’ "quicklearn-ai"
git remote add origin https://github.com/YOUR_USERNAME/quicklearn-ai.git
git branch -M main
git push -u origin main
```

### Step 2: Deploy on Render (3 min)

1. **Go to Render**: https://dashboard.render.com
2. **Click "New +"** â†’ **"Blueprint"**
3. **Connect GitHub** â†’ Select your `quicklearn-ai` repository
4. **Render auto-detects** `render.yaml` âœ…

### Step 3: Add Environment Variables

In Render dashboard, go to **quicklearn-backend** â†’ **Environment**:

#### Required (Add these):
```
GROQ_API_KEY=gsk_YOUR_GROQ_API_KEY_HERE
```

#### Optional (Add later for full features):
```
OPENAI_API_KEY=sk-your-openai-key-here
FIREBASE_ADMIN_JSON={"type":"service_account","project_id":"your-project"...}
```

#### Auto-generated (Render creates these):
- `JWT_SECRET` âœ…
- `ADMIN_TOKEN` âœ…
- `DATABASE_URL` âœ…
- `REDIS_URL` âœ…

### Step 4: Deploy!

Click **"Apply"** and wait 5-10 minutes for:
- âœ… PostgreSQL database creation
- âœ… Redis instance setup
- âœ… Backend service deployment
- âœ… Worker service deployment

### Step 5: Test Your Backend

```bash
# Get your Render URL (e.g., https://quicklearn-backend.onrender.com)
curl https://YOUR-APP.onrender.com/health
```

**Expected Response**:
```json
{
  "status": "ok",
  "timestamp": "2025-11-17T...",
  "services": {
    "redis": "connected",
    "database": "connected"
  }
}
```

### Step 6: Test AI Explanation

```bash
curl -X POST https://YOUR-APP.onrender.com/api/explain \
  -H "Content-Type: application/json" \
  -d '{"topic": "photosynthesis"}'
```

**Expected Response**:
```json
{
  "success": true,
  "topic": "photosynthesis",
  "source": "groq/compound-mini",
  "content": {
    "one_line": "Plants convert light into energy...",
    "explanation": "Photosynthesis is...",
    "analogy": "Think of it like...",
    "example": "When a leaf...",
    "formula": "6CO2 + 6H2O + light â†’ C6H12O6 + 6O2",
    "revision_note": "Remember..."
  },
  "cached": false,
  "verified": false
}
```

## ğŸ‰ Done! Your Backend is Live!

Your backend URL: `https://YOUR-APP.onrender.com`

---

## ğŸ”§ Common Issues & Fixes

### Issue: "Build Failed"
**Fix**: Check Render logs â†’ Usually missing `package.json` in root
```bash
# Add root package.json for monorepo
echo '{"name":"quicklearn-monorepo","private":true}' > package.json
git add package.json
git commit -m "Add root package.json"
git push
```

### Issue: "Environment variable not found"
**Fix**: Go to Render dashboard â†’ Environment â†’ Add `GROQ_API_KEY`

### Issue: "Database connection failed"
**Fix**: Wait 2-3 minutes for database to fully initialize

### Issue: "Redis connection failed"
**Fix**: Render Redis takes ~5 minutes to provision

---

## ğŸ“Š Monitor Your Deployment

### View Logs
1. Go to Render dashboard
2. Click **quicklearn-backend**
3. Click **"Logs"** tab
4. Watch real-time logs

### Check Metrics
1. **Request count**: Render â†’ Metrics tab
2. **Model usage**: Your backend â†’ `/api/admin/metrics`
3. **Cache hit rate**: Check Redis counters

---

## ğŸ” Security Checklist

- âœ… API keys in environment variables (not in code)
- âœ… `.env` file in `.gitignore`
- âœ… JWT secrets auto-generated by Render
- âœ… Database credentials managed by Render
- âš ï¸ Add CORS origins for your frontend domain later

---

## ğŸ’° Cost Estimate (Render Free Tier)

| Service | Plan | Cost |
|---------|------|------|
| Backend Web | Starter | **$7/month** |
| Worker | Starter | **$7/month** |
| PostgreSQL | Starter | **$7/month** |
| Redis | Starter | **$3/month** |
| **Total** | | **$24/month** |

**Free Tier**: 750 hours/month for web services (enough for 1 service)

**Cost Optimization**:
- Use free tier for web service
- Disable worker initially (verification optional)
- Use Upstash Redis (free tier)
- Use Neon/Supabase Postgres (free tier)

---

## ğŸš€ Alternative Free Deployment

### Use Free Tier Services

#### Option 1: Railway (Free $5 credit/month)
```bash
npm install -g railway
railway login
railway init
railway up
```

#### Option 2: Fly.io (Free tier available)
```bash
npm install -g flyctl
fly auth login
fly launch
fly deploy
```

#### Option 3: Heroku (No free tier, $5/month minimum)

---

## âš¡ Quick Commands

### Redeploy
```bash
git add .
git commit -m "Update"
git push
# Render auto-deploys
```

### View Logs
```bash
# Install Render CLI
npm install -g @render/cli
render login
render logs -s quicklearn-backend
```

### Rollback
```bash
# In Render dashboard:
# Deploys â†’ Click previous deploy â†’ "Redeploy"
```

---

## ğŸ“± Next: Deploy Frontend & Mobile

After backend is live:

1. **Frontend (Vercel)**:
   ```bash
   cd frontend
   vercel
   # Add env: NEXT_PUBLIC_API_URL=https://YOUR-APP.onrender.com
   ```

2. **Mobile (Expo)**:
   ```bash
   cd mobile
   # Update lib/api.js with your backend URL
   eas build --platform all
   ```

---

## ğŸ¯ Success Criteria

âœ… Health endpoint returns `{"status":"ok"}`
âœ… Explain endpoint returns AI response
âœ… Response time < 2 seconds
âœ… No errors in Render logs
âœ… Database connected
âœ… Redis connected

---

## ğŸ†˜ Need Help?

1. Check Render logs: Dashboard â†’ Logs tab
2. Test locally first: `npm run dev`
3. Verify environment variables: Dashboard â†’ Environment
4. Check database status: Dashboard â†’ quicklearn-db

---

## ğŸ“ Support

- **Render Docs**: https://render.com/docs
- **Render Community**: https://community.render.com
- **This Project**: Check TESTING.md for debugging

---

**You're ready to deploy!** ğŸš€

Just push to GitHub and connect to Render. Your backend will be live in 10 minutes!
